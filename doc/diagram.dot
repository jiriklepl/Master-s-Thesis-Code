digraph {
    subgraph ends {
        node [shape="ellipse"]

        Source
        LLVM
    }

    subgraph data {
        node [shape="parallelogram"]

        AST
        Judgements [label="Type Judgements"]
        FlatAST [label="Flat AST"]
        FlatASTAnnots [label="Flat AST\nwith block annotations"]
        MonoAST [label="Monomophized AST"]
    }

    subgraph components {
        node [shape="component"]

        Parser
        Flattener
        Infer [label="Type\ninference"]
        LRAnalysis
        Monomorphization
        Translator
    }

    subgraph decisions {
        node [shape="diamond"]
    }

    Source -> Parser -> AST
    AST -> Flattener -> FlatAST
    AST -> Infer -> Judgements -> Monomorphization
    FlatAST -> LRAnalysis -> FlatASTAnnots
    FlatASTAnnots -> Monomorphization -> MonoAST
    MonoAST -> Translator -> LLVM
}
