digraph {
    subgraph ends {
        node [shape="ellipse"]

        Source
        LLVM
    }

    subgraph data {
        node [shape="parallelogram"]

        AST
        Judgements [label="Type Judgements"]
        FlatAST [label="Flat AST"]
        BlockifiedAST [label="Blockified AST"]
        BlockifiedASTAnnots [label="Blockified AST\nwith analyzed flow"]
        MonoAST [label="Monomophized AST"]
    }

    subgraph components {
        node [shape="component"]

        Parser
        Flattener
        Infer [label="Type inference"]
        Blockifier
        FlowAnalysis [label="Flow analysis"]
        Monomorphization
        Translator
    }

    subgraph decisions {
        node [shape="diamond"]
    }

    Source -> Parser -> AST
    AST -> Flattener -> FlatAST
    AST -> Infer -> Judgements -> Monomorphization
    FlatAST -> Blockifier -> BlockifiedAST
    BlockifiedAST -> FlowAnalysis -> BlockifiedASTAnnots
    BlockifiedASTAnnots -> Monomorphization -> MonoAST
    MonoAST -> Translator -> LLVM
}
